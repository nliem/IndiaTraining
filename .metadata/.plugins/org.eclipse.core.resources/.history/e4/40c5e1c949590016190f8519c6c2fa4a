package application;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import interfaces.MyDAO;
import utils.MySQLConnection;

public class DonorDAO implements MyDAO<Donor> {
	
	private Connection con = null;
	
	public DonorDAO(){
		super();
		this.con = MySQLConnection.getMyOracleConnection();
	}
	
	public DonorDAO(Connection con){
		super();
		this.con = con;
	}

	@Override
	public int add(Donor thingToAdd) {
		int rowAdded = 0;
		
		String sqlAdd = "insert into donors values(?,?,?,?)";
		
		try{
			PreparedStatement pstmt = this.con.prepareStatement(sqlAdd);
			pstmt.setLong(1, thingToAdd.getDonorCode());
			pstmt.setString(2, thingToAdd.getDonorName());
			pstmt.setLong(3, thingToAdd.getMobileNumber());
			pstmt.setString(4, thingToAdd.getEmail());
			
			rowAdded = pstmt.executeUpdate();
		}
		catch(SQLException e){
			e.printStackTrace();
		}
		
		return rowAdded;
	}

	@Override
	public int update(long id) {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public Donor find(long id) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public int delete(long id) {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public List<Donor> findAll() {
		ArrayList<Donor> donorList = new ArrayList<>();
		
		String sqlString = "SELECT * FROM DONORS";
		
		try{
			PreparedStatement pstate = this.con.prepareStatement(sqlString);
			ResultSet rs = pstate.executeQuery();
			
			while(rs.next()){
				donorList.add(new Donor(rs.getLong("donorcode"), rs.getString("donorname"), rs.getLong("handphone"), rs.getString("email")));
			}
			
		}
	}


}
